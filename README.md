# Проект для Docker

Для нашего проекта с Flask-приложением, которое должно работать с аутентификацией пользователей Windows через keycloack, мы создадим несколько компонентов, включая Dockerfile, docker-compose.yml, приложение Flask (app.py), конфигурации для Nginx и другие необходимые файлы. Остановимся на следующих шагах:

1) Настроим Flask для обработки аутентификации с использованием keycloack.
2) Будем использовать Nginx в качестве прокси-сервера, чтобы настроить проверку аутентификации при работе с keycloack через nginx
3) Используем Docker Compose для настройки и запуска всего окружения.

Теперь наше приложение на Flask будет доступно через nginx, и аутентификация будет происходить через Keycloak. После успешной аутентификации nginx будет передавать имя пользователя через REMOTE_USER в приложение Flask.

# Техническая составляющая
## Dockerfile
В Dockerfile мы устанавливаем все зависимости для Flask-приложения.

## app.py
Это наше простое приложение Flask. Оно будет выводить логи имени пользователя, который прошел аутентификацию (передается через REMOTE_USER).

## nginx.conf
Этот файл будет настраивать nginx как реверс-прокси для нашего Flask-приложения и будет работать с аутентификацией через keycloak.

## docker-compose.yml
Для запуска проекта с использованием нескольких контейнеров, определим docker-compose.yml. Этот файл настроит все контейнеры: Flask-приложение, nginx и Keycloak.

## Настройка keycloack
Для того чтобы Nginx корректно корректно работал с keycloack, потребуется следующее:

1) Запуск контейнера в docker-compose.yml
2) Файл конфигурации реалма - keycloak-realm-export.json.
Это файл с конфигурацией реалма для keycloak, который импортируется при запуске контейнера Keycloak. Он создаст базовый реалм с клиентом и пользователем для аутентификации.


# Запуск проекта
1. Собрать и запустить контейнеры с помощью Docker Compose:

docker-compose up --build

2. Перейдите в браузер на адрес http://localhost. Если аутентификация через keycloak успешна, вы должны увидеть страницу с логином пользователя.

3. Администрирование Keycloak. 
После запуска контейнера Keycloak, вы можете получить доступ к административной панели по адресу http://localhost:8080. Логин и пароль по умолчанию: admin/admin.


